---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.16.7
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

```{code-cell} ipython3
---
editable: true
slideshow:
  slide_type: ''
---
import numpy as np
import scipy as sp
from sklearn.model_selection import train_test_split
from scipy.optimize import curve_fit

import pymc as pm
import matplotlib.pyplot as plt
import arviz as az
```

+++ {"editable": true, "slideshow": {"slide_type": ""}}

In this exercise you will be fitting model to data. The data was generated by drawing some random numbers in range (0,2) and calculating same function for each number. Then  the Gaussian noise with  mean zero and some fixed variance was added to each result.
The data is in the file `regression.txt`.

```{code-cell} ipython3
---
editable: true
slideshow:
  slide_type: ''
---
data = np.loadtxt('regression.txt')
```

+++ {"editable": true, "slideshow": {"slide_type": ""}}

## Problem 1

+++ {"editable": true, "slideshow": {"slide_type": ""}}

Fit polynomial of the second degree to the data. Use the `curve_fit` function from  `scipy.optimize`. Calculate the mean squared error (MSE).

+++ {"editable": true, "slideshow": {"slide_type": ""}}

## Problem 2 - Bayesian fit

+++ {"editable": true, "slideshow": {"slide_type": ""}}

Construct a PyMC model for the quadratic polynomial to fit to the data. Treat the $\sigma$ as an another parameter. Use the $\frac{1}{\sigma}$ prior. Use wide Gaussian priors for the polynomial coefficients.

+++ {"editable": true, "slideshow": {"slide_type": ""}}

Use `find_MAP` function to fit the model to the data. Compare the results with the result of `curve_fit`.

+++ {"editable": true, "slideshow": {"slide_type": ""}}

Generate the posterior samples for the model parameters using `sample` function.

+++ {"editable": true, "slideshow": {"slide_type": ""}}

## Errors

+++ {"editable": true, "slideshow": {"slide_type": ""}}

Check the error of the fit in each of the

```{code-cell} ipython3
---
editable: true
slideshow:
  slide_type: ''
---
x_test = np.linspace(0,2,100)
```

+++ {"editable": true, "slideshow": {"slide_type": ""}}

points. For each $x$ in $x\_test$ calculate the value of the polynomial using each posterior sample. Calculate the standard deviation. Mark this on the plot.
